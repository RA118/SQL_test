{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2024.9.252", "generated_at": "2024-09-28T17:55:10.424952Z", "invocation_id": "a45f7545-0219-482b-a6ef-87d140760e10", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-28T17:55:09.090277Z", "completed_at": "2024-09-28T17:55:09.097294Z"}, {"name": "execute", "started_at": "2024-09-28T17:55:09.099967Z", "completed_at": "2024-09-28T17:55:10.057071Z"}], "thread_id": "Thread-73 (worker)", "execution_time": 0.9730889797210693, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "clean-wonder-435309-m2", "job_id": "61be3eb3-21d4-4485-9a97-6b6e79393481", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.some_new_name2.avg_time_for_store_to_perform_five_transactions", "compiled": true, "compiled_code": "SELECT AVG(diff_hours) AS avg_time --overall avg\nFROM\n\t(SELECT \n\t-- here we calculate differences\n\t\tstore_id\n\t\t, store_name\n\t\t, MAX(happened_at) OVER (PARTITION BY store_id) AS fifth_transaction_time -- for presentation and qa purpose\n\t\t, MIN(happened_at) OVER (PARTITION BY store_id) AS first_transaction_time -- for presentation and qa purpose\n\t\t, DATETIME_DIFF(\n\t\t\t\tMAX(happened_at) OVER (PARTITION BY store_id) \n\t\t  , MIN(happened_at) OVER (PARTITION BY store_id)\n\t\t  , HOUR\n\t\t) AS diff_hours -- DATETIME_DIFF is BQ function, might be different in another DB\n\t\tFROM\n\t\t\t(SELECT\n\t\t\t-- here we count transactions per store\n\t\t\ts.id AS store_id,\n\t\t\ts.name AS store_name,\n\t\t\thappened_at,\n\t\t\tROW_NUMBER() OVER (PARTITION BY s.id ORDER BY happened_at ASC) AS nth_transaction,\n\t\t\tCOUNT(*) OVER (PARTITION BY s.id) AS max_transactions_per_store\n\n\t\t\tFROM sandbox.transactions t\n\t\t\tLEFT JOIN sandbox.device d ON t.device_id = d.id\n\t\t\tLEFT JOIN sandbox.store s ON d.store_id = s.id\n\n\t\t\tWHERE LOWER(status) = 'accepted'\n\t\t\t--AND DATE(t.happened_at) BETWEEEN DATETRUNC(TODAY(), month) AND TODAY()\n\t\t\tGROUP BY 1,2,3\n\t\t\t--ORDER BY 1,3 DESC;\n\t\t\t)\n\tWHERE max_transactions_per_store >=5 -- stores have 5 or more transactions\n\tAND nth_transaction = 1 OR nth_transaction = 5 -- we need 1st and 5th\n)", "relation_name": "`clean-wonder-435309-m2`.`dbt_ra118`.`avg_time_for_store_to_perform_five_transactions`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-28T17:55:09.091841Z", "completed_at": "2024-09-28T17:55:09.097996Z"}, {"name": "execute", "started_at": "2024-09-28T17:55:09.102429Z", "completed_at": "2024-09-28T17:55:10.067561Z"}], "thread_id": "Thread-74 (worker)", "execution_time": 0.9824683666229248, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "clean-wonder-435309-m2", "job_id": "555d58b6-5b53-4641-8f06-351e3c9ea2ba", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.some_new_name2.avg_transacted_amount_per_store_with_typology_and_country", "compiled": true, "compiled_code": "--Average transacted amount per store with typology and country\nSELECT\n\ns.country AS store_country,\ns.typology AS store_typology,\nAVG(t.amount) AS transacted_amount\n\nFROM sandbox.transactions t\nLEFT JOIN sandbox.device d ON t.device_id = d.id\nLEFT JOIN sandbox.store s ON d.store_id = s.id\n\nWHERE LOWER(status) = 'accepted'\n--AND DATE(t.happened_at) BETWEEEN DATETRUNC(TODAY(), month) AND TODAY() -- in real life there will be limitation\nGROUP BY 1,2", "relation_name": "`clean-wonder-435309-m2`.`dbt_ra118`.`avg_transacted_amount_per_store_with_typology_and_country`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-28T17:55:09.095487Z", "completed_at": "2024-09-28T17:55:09.101952Z"}, {"name": "execute", "started_at": "2024-09-28T17:55:09.109119Z", "completed_at": "2024-09-28T17:55:10.074229Z"}], "thread_id": "Thread-78 (worker)", "execution_time": 0.9864122867584229, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "clean-wonder-435309-m2", "job_id": "1e532b38-8bbc-4c3d-ab4c-7ae9088ac713", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.some_new_name2.top_ten_stores_per_transacted_amount", "compiled": true, "compiled_code": "-- Top 10 stores per transacted amount\nSELECT\ns.id AS store_id, -- added because different stores might have same name\ns.name AS store_name,\nSUM(t.amount) AS transacted_amount\n\nFROM sandbox.transactions t\nLEFT JOIN sandbox.device d ON t.device_id = d.id\nLEFT JOIN sandbox.store s ON d.store_id = s.id\n\nWHERE LOWER(t.status) = 'accepted'\n--AND DATE(t.happened_at) BETWEEEN DATETRUNC(TODAY(), MONTH) AND TODAY() -- in real life there will be limitation\nGROUP BY 1,2 ORDER BY 3 DESC\nLIMIT 10", "relation_name": "`clean-wonder-435309-m2`.`dbt_ra118`.`top_ten_stores_per_transacted_amount`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-28T17:55:09.092928Z", "completed_at": "2024-09-28T17:55:09.098492Z"}, {"name": "execute", "started_at": "2024-09-28T17:55:09.104083Z", "completed_at": "2024-09-28T17:55:10.085396Z"}], "thread_id": "Thread-75 (worker)", "execution_time": 0.9996790885925293, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "clean-wonder-435309-m2", "job_id": "21e76a51-2d09-4104-8e92-57dcae90b86f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.some_new_name2.data_model_from_cloud_cli", "compiled": true, "compiled_code": "SELECT\r\ncountry, count(distinct store_id) as stores\r\nFROM\r\n(SELECT\r\n    store.id,\r\n    store.name,\r\n    store.address,\r\n    store.city,\r\n    store.country,\r\n    store.created_at,\r\n    store.typology,\r\n    store.customer_id,\r\n    device.id AS device_id,\r\n    device.type AS device_type,\r\n    device.store_id,\r\n    transactions.id AS transactions_id,\r\n    transactions.device_id AS transactions_device_id,\r\n    transactions.product_name,\r\n    transactions.product_sku,\r\n    transactions.category_name,\r\n    transactions.amount,\r\n    transactions.status,\r\n    transactions.card_number,\r\n    transactions.cvv,\r\n    transactions.created_at AS transactions_created_at,\r\n    transactions.happened_at\r\n  FROM\r\n    `clean-wonder-435309-m2.sandbox.store` AS store\r\n    LEFT OUTER JOIN `clean-wonder-435309-m2.sandbox.device` AS device ON store.id = device.store_id\r\n    LEFT OUTER JOIN `clean-wonder-435309-m2.sandbox.transactions` AS transactions ON device.id = transactions.device_id)\r\nGROUP BY 1\r\nORDER BY 2 DESC", "relation_name": "`clean-wonder-435309-m2`.`dbt_ra118`.`data_model_from_cloud_cli`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-28T17:55:09.094583Z", "completed_at": "2024-09-28T17:55:09.099535Z"}, {"name": "execute", "started_at": "2024-09-28T17:55:09.107419Z", "completed_at": "2024-09-28T17:55:10.096355Z"}], "thread_id": "Thread-77 (worker)", "execution_time": 1.0095322132110596, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "clean-wonder-435309-m2", "job_id": "eeba0a76-b72b-4fa8-b9ce-ddc35a1eefcd", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.some_new_name2.top_ten_products_sold", "compiled": true, "compiled_code": "-- Top 10 products sold\nSELECT\nt.product_sku, -- added because different products might have same name\nt.product_name AS product_name,\nSUM(t.amount) AS transacted_amount\n\nFROM sandbox.transactions t\n--LEFT JOIN device d ON t.device_id = d.id -- don't need them here as all the fields are from t\n--LEFT JOIN store s ON d.store_id = s.id -- don't need them here as all the fields are from t\n\nWHERE LOWER(status) = 'accepted'\n--AND DATE(t.happened_at) BETWEEEN DATETRUNC(TODAY(), MONTH) AND TODAY() -- in real life there will be limitation\nGROUP BY 1,2\nORDER BY 3 DESC\nLIMIT 10", "relation_name": "`clean-wonder-435309-m2`.`dbt_ra118`.`top_ten_products_sold`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-28T17:55:09.093747Z", "completed_at": "2024-09-28T17:55:09.098953Z"}, {"name": "execute", "started_at": "2024-09-28T17:55:09.105760Z", "completed_at": "2024-09-28T17:55:10.380977Z"}], "thread_id": "Thread-76 (worker)", "execution_time": 1.2947814464569092, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "clean-wonder-435309-m2", "job_id": "ad238a62-0ae3-4ca2-a605-8af173323a18", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.some_new_name2.percentage_of_transactions_per_device_type", "compiled": true, "compiled_code": "SELECT AVG(diff_hours) AS avg_time --overall avg\nFROM\n\t(SELECT \n\t-- here we calculate differences\n\t\tstore_id\n\t\t, store_name\n\t\t, MAX(happened_at) OVER (PARTITION BY store_id) AS fifth_transaction_time -- for presentation and qa purpose\n\t\t, MIN(happened_at) OVER (PARTITION BY store_id) AS first_transaction_time -- for presentation and qa purpose\n\t\t, DATETIME_DIFF(\n\t\t\t\tMAX(happened_at) OVER (PARTITION BY store_id) \n\t\t  , MIN(happened_at) OVER (PARTITION BY store_id)\n\t\t  , HOUR\n\t\t) AS diff_hours -- DATETIME_DIFF is BQ function, might be different in another DB\n\t\tFROM\n\t\t\t(SELECT\n\t\t\t-- here we count transactions per store\n\t\t\ts.id AS store_id,\n\t\t\ts.name AS store_name,\n\t\t\thappened_at,\n\t\t\tROW_NUMBER() OVER (PARTITION BY s.id ORDER BY happened_at ASC) AS nth_transaction,\n\t\t\tCOUNT(*) OVER (PARTITION BY s.id) AS max_transactions_per_store\n\n\t\t\tFROM sandbox.transactions t\n\t\t\tLEFT JOIN sandbox.device d ON t.device_id = d.id\n\t\t\tLEFT JOIN sandbox.store s ON d.store_id = s.id\n\n\t\t\tWHERE LOWER(status) = 'accepted'\n\t\t\t--AND DATE(t.happened_at) BETWEEEN DATETRUNC(TODAY(), month) AND TODAY()\n\t\t\tGROUP BY 1,2,3\n\t\t\t--ORDER BY 1,3 DESC;\n\t\t\t)\n\tWHERE max_transactions_per_store >=5 -- stores have 5 or more transactions\n\tAND nth_transaction = 1 OR nth_transaction = 5 -- we need 1st and 5th\n)", "relation_name": "`clean-wonder-435309-m2`.`dbt_ra118`.`percentage_of_transactions_per_device_type`"}], "elapsed_time": 1.8802781105041504, "args": {"vars": {}, "log_file_max_bytes": 0, "partial_parse_file_diff": true, "populate_cache": true, "strict_mode": false, "favor_state": false, "which": "run", "require_explicit_package_overrides_for_builtin_materializations": true, "state": "/usr/src/dbt-server-shared/defer_state/run-70403122903711", "select": [], "printer_width": 80, "use_colors_file": true, "log_path": "/usr/src/dbt-server-shared/working_dir/1cc8e807-9125-4e67-92ec-15629b313fbe", "project_dir": "/usr/src/develop/user-70403103947377/environment-70403103961578/repository-70403103943939", "log_level_file": "debug", "partial_parse": true, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "version_check": true, "invocation_command": "dbt -A dbt_worker.app worker --loglevel=DEBUG --concurrency=2 --max-memory-per-child=500000", "indirect_selection": "eager", "exclude": [], "profile": "user", "require_resource_names_without_spaces": false, "quiet": false, "log_level": "info", "send_anonymous_usage_stats": true, "macro_debugging": false, "print": true, "static_parser": true, "log_format": "json", "show_resource_report": false, "introspect": true, "log_format_file": "json", "write_json": true, "empty": false, "defer": true, "profiles_dir": "/usr/src/dbt-server-shared/.dbt", "source_freshness_run_project_hooks": false}}